# ========================================================================
#                       ENCRYPTION SECTION
# ========================================================================

# Ciphers, are algorithms that define the way of data encryption after successfull authentication
# Only modern algorithms are used

Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes128-ctr

# MACs, Message Authentication Codes provide data integrity and authenticity over the session, prevents data tampering
# and packet injection attacks

MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256

# Key Exchange Algoritms, a way of defining a shared key that will be used by the ciphers to encrypt the session between
# 2 peers. a good algorithm prevents MITM, or guessing the session key.
# Remove the file /etc/ssh/moduli because diffie-hellman algorithms are not used.

KexAlgorithms mlkem768x25519-sha256,sntrup761x25519-sha512,sntrup761x25519-sha512@openssh.com

# A list of supported algorithms used during the KEX init process to identify the server to the client by a public host
# key and a kex signature that was made with the help of the private key
# Remove the ecdsa host key, won't be used anyway with this configuration.

HostKeyAlgorithms ssh-ed25519-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256

# This conf defines the minimum length of the RSA key that SSH will offer. the default is 3072 which is weak for
# modern standards, if possible avoid using RSA. The minimum recommended size for supported RSA keys are 4096 and higher
# which will increase security but slower operations.

RequiredRSASize 4096

# A list of public/private key algorithms used for authenticating users, if a user will try to use ecdsa keys to authenticate
# it will fail. only the defines algorithms are supported in this configuration.

PubkeyAcceptedAlgorithms ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256

# A list of accepted algorithms that are used during host based authentication type

HostbasedAcceptedAlgorithms ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256

# ========================================================================
#                       AUTHENTICATION SECTION
# ========================================================================

# Disables the ability to use passwords for authentication which prevents brute force attacks, rainbow tables, and completley
# removes an entire attack surface related to passwords.

PasswordAuthentication no

# In case password authentication is permitted then its recommended to explicitly disable empty password authentication
# this type of authentication does no authenticate users

PermitEmptyPasswords no

# Disables the ability to authenticate as the root user, recommended to use this user locally only and in emergancy scenarios

PermitRootLogin no

# Enables to authenticate users with private/public keys, recommended to use and avoid using passwords

PubkeyAuthentication yes

# This param gives you the ability to specify which authentication methods you want your system to supported

AuthenticationMethods publickey

# Specifies if host based authentication is allowed on the server, explicilty set to no

HostbasedAuthentication no

